# CRUD
### CRUD
- 대부분의 소프트웨어가 가지는 기본적인 데이터 처리 기능인 생성, 조회, 수정, 삭제를 묶어 이르는 말
- Django에서는 QuerySet API를 통해, 복잡한 SQL문 없이 Python 코드르 CRUD 작업을 직관적으로 수행 가능

## Create
- 데이터 객체를 생성하는 3가지 방법
    1. 빈 객체 생성 후 값 할당 및 저장
    2. 초기 값과 함께 객체 생성 및 저장
    3. `create()` 메서드로 한 번에 생성 및 저장

### 빈 객체 생성 후 값 할당 및 저장
```shell
# 특정 테이블에 새로운 행을 추가하여 데이터 추가

>>> article = Article()
>>> article
<Article: Article object (None)>

>>> article.title = 'first'
>>> article.content = 'django!'
>>> article.save()
>>> article
<Article: Article object (1)>
```

### 초기 값과 함께 객체 생성 및 저장
```shell
>>> article = Article(title='second', content='django!')
>>> article
<Article: Article object object (None)>

>>> article.save()

>>> article
<Article: Article object (2)>

>>> Article.objects.all()
<QuerySet [<Article: Article object (1)>, <Article: Article object (2)>]>
```

### `create()` 메서드로 한 번에 객체 생성 및 저장
```shell
# 저장 이후 바로 생성된 데이터 반환

>>> Article.objects.create(title='third', content='django!')
<Article: Article object (3)>
```

### `save()` 메서드
- 객체를 데이터베이스에 저장하는 인스턴스 메서드
- 객체를 먼저 생성한 후, 데이터베이스에 저장하기 전에 추가적인 처리가 필요할 때 `save()`를 호출

## Read
### 대표적인 조회 메서드
- QuerySet 반환 메서드
    - `all()`
    - `filter()`
- QuerySet을 반환하지 않는 메서드
    - `get()`

### `all()`
```shell
>>> Article.objects.all()
<QuerySet [<Article: Article object (1)>, <Article: Article object (2)>, <Article: Article object (3)>]>
```
- 전체 데이터 조회

### `filter()`
```shell
>>> Article.objects.filter(content='django!')
<QuerySet [<Article: Article object (1)>, <Article: Article object (2)>, <Article: Article object (3)>]>

>>> Article.objects.filter(title='abc')
<QuerySet []>

>>> Article.objects.filter(title='first')
<QuerySet [<Article: Article object (1)>]>
```
- 주어진 매개변수와 일치하는 객체를 포함하는 QuerySet 반환

### `get()`
```shell
>>> Article.objects.get(pk=1)
<Article: Article object (1)>

>>> Article.objects.get(pk=100)
DoesNotExist: Article matching query does not exist.

>>> Article.objects.get(content='django!')
MultipleObjectsReturned: get() returned more than one Article -- it returned 2!
```
- 주어진 매개변수와 일치하는 **객체를 반환**
- QuerySet을 반환하지 않음
- 객체를 찾을 수 없으면 `DoesNotExist` 예외를 발생시키고,
둘 이상의 객체를 받으면 `MultipleObjectsReturned` 예외를 발생시킴
- **primary key**와 같이 **고유성(uniqueness)을 보장하는 조회**에서 사용해야 함

### Field lookups
```python
Article.objects.filter(title_startswith='second')
```
- 단순 동치 비교를 넘어 더 상세한 조건으로 데이터를 조회할 수 있는 기능
- 복잡한 데이터 조회도 간결하고 강력하게 처리할 수 있음
- 모델의 필드 이름 뒤에 **이중 밑줄(double underscore)을 붙이고, 원하는 조회 유형을 명시하는 방식으로 사용
- `filter()`, `exclude()` 및 `get()`에 대한 키워드 인자로 지정, 손쉽게 필터링 로직을 구성

## Update
```shell
# 수정할 인스턴스 조회
>>> article = Article.objects.get(pk=1)

# 인스턴스 변수를 변경
>>> article.title = 'byebye'

>>> article.save()
```
- 인스턴스 변수를 변경 후 save 메서드 호출

## Delete
```shell
# 삭제할 인스턴스 조회
>>> article = Article.objects.get(pk=1)

# delete 메서드 호출(삭제된 객체가 반환)
>>> article.delete()
(1, {'articles.Article': 1})

# 삭제한 데이터는 더 이상 조회할 수 없음
>>> Article.objects.get(pk=1)
DoesNotExist: Article matching query does not exist.
```