# Django Model
### Model
- 데이터베이스와 Python 클래스로 추상화된 형태로 상호작용
- 개발자가 데이터베이스에 대한 깊은 지식 없이도 쉽게 데이터 관리 가능
- 유지 보수 및 확장성 증대
    - 데이터베이스 변경 시에도 코드 수정 최소화, 재사용 가능한 데이터 모델을 통해 개발 효율성 향상

### Model을 통한 DB 관리
- `urls.py`
    - 사용자 요청의 시작점
- `views.py`
    - 요청을 처리하고 `models.py`를 통해 데이터를 다룸
- `models.py`
    - 데이터베이스를 정의하고, 데이터베이스와 상호작용
- `templates`
    - `views.py`로부터 받은 데이터를 사용자에게 보여줄 화면을 구성

## Model Class
### Model Class
- DB의 테이블을 정의하고 데이터를 조작할 수 있는 기능들을 제공
- 데이터베이스 테이블의 구조를 설계하는 청사진 역할

### Model Class 작성
```python
# articles/models.py
class Article(models.Model):
    title = models.CharField(max_length=10)
    content = models.TextField()
```
- 작성한 모델 클래스는 최종적으로 DB에 테이블 구조를 만듦
- `django.db.models` 모듈의 Model이라는 부모 클래스를 상속받음
    - Model은 model에 관련된 모든 코드가 이미 작성되어 있는 Class
    - 개발자는 가장 중요한 **테이블 구조를 어떻게 설계할지에 대한 코드만 작성**하도록 하기 위함

        ("상속"을 활용한 프레임워크의 기능 제공)
- 클래스 변수명(`title`, `content`)
    - 테이블의 각 필드(열) 이름
- Model Field(`CharField()`, `TextField()`)
    - 데이터베이스 테이블의 열을 나타내는 중요한 구성 요소
    - "데이터의 유형"과 "제약 조건"을 정의

# Model Field
### Model Field
1. Field types(필드 유형)
    - 데이터베이스에 저장될 "데이터의 종류"를 정의
2. Field options(필드 옵션)
    - 필드의 "동작"과 "제약 조건"을 정의

## Field Types
### Field Types
- 데이터베이스에 저장될 **데이터의 종류**를 정의
- `models` 모듈의 클래스로 정의되어 있음
- `CharField()`
    - 제한된 길이의 문자열을 저장
    - 필드의 최대 길이를 결정하는 `max_length`는 선택 옵션
- `TextField()`
    - 길이 제한이 없는 대용량 텍스트를 저장
    - 무한대는 아니며, 사용하는 시스템에 따라 달라짐
- 주요 필드 유형
    - 문자열 필드

        `CharField`, `TextField`
    - 숫자 필드

        `IntegerField`, `FloatField`
    - 날짜/시간 필드
    
        `DateField`, `TimeField`, `DateTimeField`
    - 파일 관련 필드
    
        `FileField`, `ImageField`

## Field Options
### Field Options
- 필드의 **동작**과 **제약 조건**을 정의

### 제약 조건
- 특정 규칙을 강제하기 위해 테이블의 열이나 행에 적용되는 규칙이나 제한사항
- 숫자만 저장되도록 제한을 두거나, 문자가 100자까지만 저장되도록 하는 등의 제한 조건을 의미

### 주요 필드 옵션
- `null`
    - 데이터베이스에서 `NULL`값을 허용할지 여부를 결정
    - 기본값: `False`
- `blank`
    - `form`에서 빈 값을 허용할 지 여부를 결정
    - 기본값: `False`
- `default`
    - 필드의 기본값을 설정

# Migrations
### Migrations
- model 클래스의 변경사항을 DB에 최종 반영하는 방법
- 모든 변경 사항이 코드로 관리되어 협업 시 모델 변경 내역에 대한 추적과 공유가 수월함

### Django 모델 클래스와 Migration 과정
```python
# articles/models.py

class Article(models.Model):
    title = models.CharField(max_length=10)
    content = models.TextField()
```

```bash
$ python manage.py makemigrations
```
```bash
$ python manage.py migrate
```

### 테이블에 필드를 추가
- 이미 기존 테이블이 존재하는 경우, 새 필드를 추가할 때 문제가 발생할 수 있음
    - 기존에 레코드가 있는 테이블에 새로운 필드를 추가하면 어떤 값으로 채울 지 결정해야 함
    - Django의 `makemigrations` 실행 시 기본값 설정을 요구하는 프롬프트가 표시됨
- 새로운 필드 작성
    ```python
    # articles/models.py
    class Article(models.Model):
        title = models.CharField(max_length=10)
        content = models.TextField()
        created_at = models.DateTimeField(auto_now_add=True)
        updated_at = models.DateTiemField(auto_now = True)
    ```
- 새로운 필드 추가 후 `makemigrations` 명령어 입력
    ```bash
    $ python manage.py makemigrations
    ```
    ```Text
    It is impossible to add the field 'created_at' with 'auto_now_add=true' to article without providing a default.
    This is because the database nedds something to populate existing rows.
        1) Provide a one-off default now which will be set on all existing rows
        2) Quit and manually define a default value in modes.py
    Select an option:
    ```
    - 이미 기존 테이블이 존재하기 때문에 필드를 추가할 때 필드의 기본 값 설정이 필요
- 추가하는 필드의 기본값 입력
    - 날짜 데이터이기 때문에 직접 입력하기 보다 Django가 제안하는 기본값을 사용하는 것을 권장
- `migrate`
    ```bash
    $ python manage.py migrate
    ```