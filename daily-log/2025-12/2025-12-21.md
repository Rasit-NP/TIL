# 2025-12-21

## ğŸ§  ì˜¤ëŠ˜ ë°°ìš´ ê²ƒ
- FastAPI ê¸°ë³¸ ì‚¬ìš©ë²•

### ê°œìš”
- FastAPIëŠ” íƒ€ì… íŒíŠ¸ ê¸°ë°˜ì˜ ìë™ ê²€ì¦, ë¹„ë™ê¸° ì§€ì›ì„ ì œê³µí•´ ìƒì‚°ì„±ê³¼ ì„±ëŠ¥ì„ ë™ì‹œì— ë§Œì¡±ì‹œí‚¤ëŠ” í˜„ëŒ€ì  API í”„ë ˆì„ì›Œí¬
    - Pydanticê³¼ ì˜ì¡´ì„± ì£¼ì…ì„ í™œìš©í•œ êµ¬ì¡°í™”ê°€ í•µì‹¬
- ë‚´ë¶€ì ìœ¼ë¡œ Starlette(ASGI)ì™€ Pydantic(ë°ì´í„° ê²€ì¦)ì„ ì‚¬ìš©

### ì¥ì 
- ASGI(Asynchronous Server Gateway Interface) ê¸°ë°˜ì˜ ë†’ì€ ì„±ëŠ¥
    - ë™ì¼ í•˜ë“œì›¨ì–´ ê¸°ì¤€ì—ì„œ ë” ë§ì€ ìš”ì²­ì„ ì²˜ë¦¬ ê°€ëŠ¥
    - ì‹¤ì‹œê°„ API, ëŒ€ê·œëª¨ íŠ¸ë˜í”½ ì„œë¹„ìŠ¤ì— ì í•©
- íƒ€ì… íŒíŠ¸ ê¸°ë°˜ì˜ ìë™ ê²€ì¦
    - ì´ë¥¼ Pydanticì´ ë‹´ë‹¹
- ì§€ë™ API ë¬¸ì„œ ìƒì„±
    - ë³„ë„ ì„¤ì • ì—†ì´ ì•„ë˜ê°€ ìë™ ìƒì„±ë¨
        - Swagger UI(`/docs`)
        - ReDoc(`/redoc`)
        - OpenAPI JSON ìŠ¤í™
    - ëª¨ë“  path, query, body, response, status codeê°€ ë¬¸ì„œì— ë°˜ì˜ë¨
    - í”„ë¡ íŠ¸ì—”ë“œ$\cdot$ëª¨ë°”ì¼$\cdot$ì™¸ë¶€ í˜‘ì—… ì‹œ ë¬¸ì„œ ì‘ì„± ë¹„ìš© ê±°ì˜ ì—†ìŒ
    - API ë³€ê²½ ì‹œ ë¬¸ì„œì™€ ì½”ë“œ ë¶ˆì¼ì¹˜ ë¬¸ì œ ì—†ìŒ
- ê°œë°œ ì†ë„ê°€ ë§¤ìš° ë¹ ë¦„
    - ê¸°ë³¸ CRUD APIëŠ” ìˆ˜ ë¶„ ë‚´ ì‘ì„± ê°€ëŠ¥
    - ì„ ì–¸í˜• ì½”ë“œ ìŠ¤íƒ€ì¼ë¡œ ê°€ë…ì„±ì´ ë†’ìŒ
    - ê°œì¸ í”„ë¡œì íŠ¸, ìŠ¤íƒ€íŠ¸ì—…, MVP ê°œë°œì— ë§¤ìš° ìœ ë¦¬
    - ì‹¤ìˆ˜ë¡œ ì¸í•œ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ ë¹„ìš© ê°ì†Œ
- ì˜ì¡´ì„± ì£¼ì…(Dependency Injection)ì´ ê°•ë ¥í•¨
    - ì¸ì¦, DB ì„¸ì…˜, ê³µí†µ ë¡œì§ì„ í•¨ìˆ˜ ë‹¨ìœ„ë¡œ ë¶„ë¦¬ ê°€ëŠ¥
    - í…ŒìŠ¤íŠ¸, ìœ ì§€ë³´ìˆ˜, ì½”ë“œ ì¬ì‚¬ìš©ì„±ì´ ë›°ì–´ë‚¨
- ë¹„ë™ê¸°ì™€ ë™ê¸° ì½”ë“œì˜ ê³µì¡´
    - `async def`ì™€ `def`ë¥¼ ë™ì‹œì— ì§€ì›
    - ë™ê¸° í•¨ìˆ˜ëŠ” ìë™ìœ¼ë¡œ ìŠ¤ë ˆë“œí’€ì—ì„œ ì‹¤í–‰ë¨
    - ê¸°ì¡´ ë™ê¸° ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš© ê°€ëŠ¥
    - ì ì§„ì  async ì „í™˜ ê°€ëŠ¥
- í…ŒìŠ¤íŠ¸ ì¹œí™”ì  êµ¬ì¡°
    - `TestClient`ë¡œ ì‹¤ì œ HTTP ìš”ì²­ê³¼ ë™ì¼í•˜ê²Œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
    - ì˜ì¡´ì„± ì˜¤ë²„ë¼ì´ë“œê°€ ì‰¬ì›€
- Python ìƒíƒœê³„ì™€ì˜ í˜¸í™˜ì„±
    - SQLAlchemy, Alembic, Celery, Redis, Kafka ë“±ê³¼ ìì—°ìŠ¤ëŸ½ê²Œ ì—°ë™
    - Django ëŒ€ë¹„ ê²½ëŸ‰, Flask ëŒ€ë¹„ êµ¬ì¡°í™”ë¨

### ë‹¨ì 
- ëŸ¬ë‹ ì»¤ë¸Œê°€ ë‚®ì§€ ì•ŠìŒ
    - ì•„ë˜ ê°œë…ë“¤ì„ ë™ì‹œì— ì´í•´í•´ì•¼ í•¨
        - Python íƒ€ì… íŒíŠ¸
        - Pydantic ëª¨ë¸
        - ASGI / async / await
        - ì˜ì¡´ì„± ì£¼ì…
    - Flaskë³´ë‹¤ ì´ˆë°˜ í•™ìŠµ ë¹„ìš©ì´ í¼
- ORM ë° ê´€ë¦¬ì ê¸°ëŠ¥ ë¯¸í¬í•¨
    - Djangoì™€ ë‹¬ë¦¬ ì•„ë˜ ê¸°ëŠ¥ì´ ê¸°ë³¸ ì œê³µë˜ì§€ ì•ŠìŒ
        - ORM
        - Admin í˜ì´ì§€
        - ì¸ì¦/ê¶Œí•œ ì‹œìŠ¤í…œ
        - ë§ˆì´ê·¸ë ˆì´ì…˜
    - ëª¨ë“  ì„ íƒì„ ê°œë°œìê°€ ì§ì ‘ í•´ì•¼ í•¨
    - í”„ë¡œì íŠ¸ ì´ˆë°˜ ì„¤ê³„ ë¶€ë‹´ ì¦ê°€
- ëŒ€ê·œëª¨ í”„ë¡œì œê·¸ì—ì„œ êµ¬ì¡° í†µì œê°€ ì–´ë ¤ìš¸ ìˆ˜ ìˆìŒ
    - ììœ ë„ê°€ ë†’ì•„ ì•„ë˜ ì›ì¹™ì´ ëŠìŠ¨í•´ì§ˆ ìˆ˜ ìˆìŒ
        - íŒŒì¼ êµ¬ì¡°
        - ë ˆì´ì–´ ë¶„ë¦¬
        - ì±…ì„ ë¶„ë¦¬
    - Django: ê°•í•œ ê·œì¹™
    - FastAPI: ë†’ì€ ììœ ë„
- ë¬¸ì„œ ìë™í™”ì— ëŒ€í•œ ê³¼ë„í•œ ì˜ì¡´ ìœ„í—˜
    - Swagger ë¬¸ì„œê°€ ì˜ ë³´ë”˜ë‹¤ëŠ” ì´ìœ ë¡œ API ì„¤ê³„ ê²€ì¦ì„ ì†Œí™€íˆ í•˜ëŠ” ê²½ìš° ë°œìƒ
    - ë¬¸ì„œëŠ” ê²°ê³¼ë¬¼, ì„¤ê³„ëŠ” ë³„ë„ ì‘ì—…ì´ í•„ìš”
- ë¹„êµì  ì§§ì€ ì—­ì‚¬
    - Django(2005~) ëŒ€ë¹„ ìƒëŒ€ì ìœ¼ë¡œ ìµœì‹  í”„ë ˆì„ì›Œí¬
    - ëŒ€ê¸°ì—… ë ˆê±°ì‹œ í”„ë¡œì íŠ¸ ì‚¬ë¡€ëŠ” ìƒëŒ€ì ìœ¼ë¡œ ì ìŒ
- ì„¤ì • ë¯¸í  ì‹œ ë³´ì•ˆ ì·¨ì•½
    - CORS, ì¸ì¦, ë¬¸ì„œ ê³µê°œ ì„¤ì •ì„ ì˜ëª»í•˜ë©´ ì•„ë˜ ì·¨ì•½ì  ë°œìƒ ê°€ëŠ¥
        - `/docs` ê³µê°œ
        - ì¸ì¦ ì—†ëŠ” API ë…¸ì¶œ

### FastAPI, Django, Flask
|í•­ëª©   |FastAPI    |Django |Flask|
|-|-|-|-|
|ì„±ëŠ¥   |ë§¤ìš° ë†’ìŒ  |ì¤‘ê°„   |ì¤‘ê°„   |
|ë¹„ë™ê¸° |ë„¤ì´í‹°ë¸Œ   |ì œí•œì  |ì œí•œì  |
|ìë™ ë¬¸ì„œ  |ê¸°ë³¸ ì œê³µ  |ì™¸ë¶€ ë„êµ¬  |ì™¸ë¶€ ë„êµ¬  |
|êµ¬ì¡° ê°•ì œ  |ë‚®ìŒ   |ë§¤ìš° ë†’ìŒ  |ë§¤ìš° ë‚®ìŒ  |
|í•™ìŠµ ë‚œì´ë„    |ì¤‘~ìƒ  |ì¤‘ |í•˜ |
|í’€ìŠ¤íƒ ì§€ì›    |X  |O  |X  |

### FastAPIê°€ ì í•©í•œ ê²½ìš°
- REST API / GraphQL ì„œë²„
- ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤
- ì‹¤ì‹œê°„ API
- AI$\cdot$ë°ì´í„° ì„œë¹„ìŠ¤ ë°±ì—”ë“œ
- ê°œì¸ í¬íŠ¸í´ë¦¬ì˜¤, ê¸°ìˆ  ì‹œì—°ìš© í”„ë¡œì íŠ¸

### FastAPIì™€ ASGI ì„œë²„(Uvicorn) ì„¤ì¹˜
```bash
pip install fastapi "uvicorn[standard]"
```
- `uvicorn[standard]`ë¥¼ ê¶Œì¥

### ì²« ë²ˆì§¸ ì•±
- íŒŒì¼
    ```python
    # main.py
    from fastapi import FastAPI

    app = FastAPI()

    @app.get("/")
    async def read_root():
        return {"message": "Hello, FastAPI"}
    ```
- ì‹¤í–‰
    ```bash
    uvicorn main:app --reload
    # ê¸°ë³¸: http://127.0.0.1:8000
    ```
    - ê°œë°œ í¸ì˜ë¥¼ ìœ„í•´ `--reload` ì‚¬ìš©(íŒŒì¼ ë³€ê²½ ì‹œ ì¬ì‹œì‘)

### ê²½ë¡œ ì—°ì‚°ì(Path operations)
- ê²½ë¡œ ë§¤ê°œë³€ìˆ˜ (Path params)
    ```python
    @app.get("/items/{item_id}")
    def read_item(itme_id: int):
        return {"item_id": item_id}
    ```

- ì¿¼ë¦¬ ë§¤ê°œë³€ìˆ˜ (Query params):
    ```python
    @app.get("/search")
    def search(q: str | None = None, limit: int = 10):
        return {"q": q, "limit": limit}

- ìš”ì²­ ë³¸ë¬¸ (JSON Body)
    - Pydantic ëª¨ë¸ê³¼ í•¨ê»˜ ì‚¬ìš© ê¶Œì¥

### Pydantic ëª¨ë¸ê³¼ ë°ì´í„° ê²€ì¦ (ìš”ì²­/ì‘ë‹µ ëª¨ë¸)
```python
from pydantic import BaseModel, Field
from typing import Optional

class Item(BaseModel):
    name: str = Field(..., min_length=1, max_length=100)
    price: float
    tags: Optional[list[str]] = []

@app.post("/items", response_model=Item, status_code=201)
def create_item(item: Item):
    # itemì€ ì´ë¯¸ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ í†µê³¼í•œ Pydantic ê°ì²´
    return item
```
- FastAPIëŠ” Pydanticì˜ `BaseModel`ì„ ì‚¬ìš©í•´ ìš”ì²­ ë°ì´í„° ê²€ì¦ ë° ì§ë ¬í™”ë¥¼ ìˆ˜í–‰
- ê° í•„ë“œì˜ íƒ€ì… íŒíŠ¸ëŒ€ë¡œ ìë™ ë³€í™˜ ë° ê²€ì¦ì´ ì ìš©ë¨
- `Field()`ë¡œ ì¶”ê°€ ë©”íƒ€/ì œì•½(ì˜ˆ: `min_length`, `regex`) ì„ ì–¸ ê°€ëŠ¥
- ì‘ë‹µ ìŠ¤í‚¤ë§ˆë¥¼ `response_model`ë¡œ ì§€ì •í•˜ë©´ ë¶ˆí•„ìš”í•œ í•„ë“œë¥¼ í•„í„°ë§í•˜ê³  ë¬¸ì„œí™”ë¨

### ì˜ì¡´ì„± ì£¼ì…
```python
from fastapi import Depends

def common_parameters(q: str | None = None, limit: int = 10):
    return {"q": q, "limit": limit}

@app.get("/items/")
def read_items(commons: dict = Depends(common_parameters)):
    return commons
```
- FastAPIì˜ DI(Dependency Injection)ëŠ” ê²½ë¡œ í•¨ìˆ˜ì˜ ì¸ìë¡œ `Depends`ë¥¼ ì„ ì–¸í•˜ë©´ ë™ì‘
- DB ì—°ê²°, ê³µí†µ íŒŒë¼ë¯¸í„°, ì¸ì¦ ë“±ì„ ëª¨ë“ˆí™”í•  ë•Œ ë§¤ìš° ìœ ìš©
- ì˜ì¡´ì„±ì—ì„œëŠ” ì˜ˆì™¸ ì²˜ë¦¬, ë¦¬ì†ŒìŠ¤ íšë“/í•´ì œ(yield ì‚¬ìš©) ë“±ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŒ

### ë¹„ë™ê¸°(async) vs. ë™ê¸°(sync)
- FastAPIëŠ” ASGI ê¸°ë°˜ìœ¼ë¡œ `async def` ê²½ë¡œë¥¼ ì§€ì›
    - I/O ë°”ìš´ë“œ(ë°ì´í„°ë² ì´ìŠ¤, ì™¸ë¶€ API ë“±) ì‘ì—… ì‹œ `async`ë¥¼ ì‚¬ìš©í•˜ë©´ ì„±ëŠ¥ ì´ì ì´ í¼
- CPU ë°”ìš´ë“œ ì‘ì—…ì€ ë³„ë„ ì›Œì»¤(ex. Celery)ë¡œ ë¶„ë¦¬ ê¶Œì¥
- ë™ê¸° í•¨ìˆ˜ë„ ê·¸ëŒ€ë¡œ ì‚¬ìš© ê°€ëŠ¥í•˜ë©° FastAPIê°€ ìë™ìœ¼ë¡œ ìŠ¤ë ˆë“œí’€ì—ì„œ ì‹¤í–‰

### ì˜ˆì™¸ ì²˜ë¦¬ ë° HTTPException
```python
from fastapi import HTTPException, status

@app.get("/users/{user_id}")
def get_user(user_id: int):
    user = get_from_db(user_id)
    if not user:
        raise HTTPEXception(status_code=status.HTTP_404_NOT_FOUND, detail="User not found")
    return user
```
- ì „ì—­ ì˜ˆì™¸ ì²˜ë¦¬ê°€ í•„ìš”í•˜ë©´ `app.exception_handler()`ë¡œ ì»¤ìŠ¤í…€ í•¸ë“¤ëŸ¬ ë“±ë¡ ê°€ëŠ¥

### íŒŒì¼ ì—…ë¡œë“œ / í¼ / multipart
```python
from fastapi import File, UploadFile

@app.post("/upload")
async def upload(file: UploadFile = File(...)):
    contents = await file.read()
    return {"filename": file.filename, "size": len(contents)}
```
- í° íŒŒì¼ì€ ìŠ¤íŠ¸ë¦¬ë° ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬í•˜ê±°ë‚˜ ì„ì‹œ íŒŒì¼ë¡œ ì €ì¥í•˜ë„ë¡ ì„¤ê³„

### Background Tasks
```python
from fastapi import BackgroundTasks

def write_log(message: str):
    with open("log.txt", a) as f:
        f.write(message + '\n')

@app.post("/process")
def process(background_tasks: BackgroundTasks, payload: dict):
    backgound_tasks.add_task(write_log, "processed")
    return {"status", "accepted"}
```
- ê°„ë‹¨í•œ ë¹„ë™ê¸° í›„ì²˜ë¦¬ ì‘ì—…ì— ì í•©

### WebSocket
```python
from fastapi import WebSocket

@app.websocket("/ws")
async def websocket_endpoint(ws: WebSocket):
    await ws.accept()
    while True:
        data = await ws.receive_text()
        await ws.send_text(f"Echo: {data}")
```

### ë¯¸ë“¤ì›¨ì–´ / CORS
```python
from starlette.middleware.cors import CORSMiddleware

app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],
    allow_methods=["*"],
    allow_headers=["*"],
)
```
- ë³´ì•ˆìƒ ìš´ì˜ í™˜ê²½ì—ì„œëŠ” `allow_origins=[*]` ì‚¬ìš©ì— ì£¼ì˜

### ë³´ì•ˆ(ì¸ì¦/ì¸ê°€) ê¸°ë³¸
```python
from fastapi.security import OAuth2PasswordBearer

oauth2_scheme = OAuth2PasswordBearer(tokenUrl="token")
@app.get("/users/me")
def read_users_me(token: str = Depends(oauth2_scheme)):
    # í† í° ê²€ì¦ ë¡œì§ í•„ìš”
    return {"token": token}
```
- FastAPIëŠ” OAuth2, API Key ë“± ì—¬ëŸ¬ ë³´ì•ˆ ìŠ¤ì¹´ë§ˆë¥¼ ì§€ì›
    - ì˜ˆë¡œ, `OAuth2PasswordBearer`ë¥¼ ì´ìš©í•´ í† í° ê¸°ë°˜ ì¸ì¦ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŒ
        - í† í° ë°œê¸‰ ë° ê²€ì¦ì€ ë³„ë„ ë¡œì§ í•„ìš”
- JWTë¥¼ ì‚¬ìš©í•œ ì¸ì¦ì€ í† í° ìƒì„±/ê²€ì¦ ë¼ì´ë¸ŒëŸ¬ë¦¬(PyJWT ë“±)ë¥¼ í†µí•´ êµ¬í˜„

### í…ŒìŠ¤íŠ¸ (TestClient)
```python
from fastapi.testclient import TestClient

client = TestClient(app)

def test_read_root():
    response = client.get("/")
    assert response.status_code == 200
    assert response.json() == {"message": "Hello, FastAPI!"}
```
- FastAPIëŠ” `starlette.testclient.TestClient`ë¥¼ í†µí•´ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥

### ì²´í¬ë¦¬ìŠ¤íŠ¸
- íƒ€ì… íŒíŠ¸ì™€ Pydantic ëª¨ë¸ì„ ì ê·¹ í™œìš©í•´ ë°ì´í„° ì˜¤ë¥˜ë¥¼ ì´ˆê¸°ì— ì¡ì„ ê²ƒ
- DB ì—°ê²°(íŠ¹íˆ async ë“œë¼ì´ë²„)ì€ ì˜ì¡´ì„±ìœ¼ë¡œ ê´€ë¦¬í•˜ê³  ì—°ê²° í’€ì„ í™œìš©í•  ê²ƒ
- ëŒ€ìš©ëŸ‰ íŒŒì¼ ì²˜ë¦¬ ì‹œ ìŠ¤íŠ¸ë¦¬ë° íŒ¨í„´ ì ìš©
- ì„±ëŠ¥
    - CPU ë°”ìš´ë“œ ë¡œì§ì€ ì›Œì»¤/ì™¸ë¶€ ì„œë¹„ìŠ¤ë¡œ ë¶„ë¦¬
    - I/O ë°”ìš´ë“œëŠ” asyncë¡œ ì²˜ë¦¬